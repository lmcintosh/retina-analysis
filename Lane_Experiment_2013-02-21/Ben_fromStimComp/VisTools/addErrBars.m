function addErrBars(data, uErrs, lErrs, color)% ADDERRBARS - adds error bars to plots or bar charts%	ADDERRBARS([XDATA YDATA], UERRS, LERRS) draws error bars%	of length uErrs above and lErrs below the means at (xdata,ydata)%	ADDERRBARS([XDATA YDATA], UERRS) draws symmetric error bars%	ADDERRBARS(YDATA,...) assumes that x = [1; 2; 3 ...]%%	Variables must in columns.%%	bug: all error bars are drawn at the exact x-values, which is a%		problem for bar graphs having multiple data series%	lkc 11/4/2000if nargin == 2		% symmetric errors	lErrs = uErrs;	colors = get(gca, 'ColorOrder');elseif nargin == 3	colors = get(gca, 'ColorOrder');endnumColors = size(colors, 1);[r c] = size(data);[er ec] = size(uErrs);if (((c-1 ~= size(uErrs, 2)) & c>1) | r~=er )	error('must have equal numbers of errors and y-data');endif c == 1 			% if y data only, assume x is linear	data(:, 2) = (1:r)';	% as in, i.e., a bar graph	data = fliplr(data);endfor j =  1:c	for k =  1:r		h=line([data(k,1) data(k,1)], [data(k,j+1)-lErrs(k, j) data(k,j+1)+uErrs(k, j)]);		if j <= numColors			colIndex = j;		else 			colIndex = rem(j, numColors);		end		color = colors(colIndex, :);		set(h, 'Color', color);	endend