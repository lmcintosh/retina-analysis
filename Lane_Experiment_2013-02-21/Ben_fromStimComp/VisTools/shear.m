function y = shear(x, n)%% SHEAR 	successively offset rows of an array%			or an array-nee-vector.  Useful for %			making space-time diagrams.%% usage:%	SHEAR(X, N) shears the rows of X by N elements per row.%	If X is a vector, it is expanded into a square array and%			then sheared.%     % see also: roll, turn, shift% % Lawrence K. Cormack% history:% 10/25/00  lkc Wrote it.% 7/4/02    lkc changed name from "autoturn()"% 7/4/02    lkc Cleaned up the comments.% 7/4/02    lkc added second argument (variable shear)% 5/24/11   lkc no longer considers short dimension as the rowsif nargin == 1, n = 1; end;[r c] = size(x);if r == 1	x = repmat(x, c, 1);elseif c==1	x = repmat(x', r, 1);end	for i = 1:r    x(i,:) = turn(x(i,:),(i.*n));endy=x;