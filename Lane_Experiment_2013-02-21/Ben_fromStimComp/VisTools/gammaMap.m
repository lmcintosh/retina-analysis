function y = gammaMap(map, gamma, xo)% GAMMAMAP	 gamma corrects an existing map%	y = gammamap(map, [gamma], [xo]) %	Gammamap makes a map suitable for screen(setclut), i.e. in the%	range (0-255).  If you want to use the output for a MATLAB colormap,%	normalize the values to the range (0-1).%	4/15/01 - fixed bonehead normalization bugif nargin == 2	xo = 0;elseif nargin == 1 	xo = 0;	gamma = 2.4;	% measured by lkc, 12/14/99, for the sony in Mez 108elseif nargin == 0	xo = 0;	gamma = 2.4;	% measured by lkc, 12/14/99, for the sony in Mez 108	nentries = 256;%	map = linspace(0, 1, nentries);elseif nargin ~= 3	error('GAMMAMAP: must have zero to three arguments');endlutmax = 255;if nargin ~= 0, 	[rin cin] = size(map);	nentries = rin;  	map = map./lutmax;end;%y = map.^(1./gamma) - xo; y = (1-xo).*(map.^(1./gamma)) - xo;y = halfwave(round(lutmax.*y));% y = halfwave(round(y));if(cin == 1),	y = [y y y];end 