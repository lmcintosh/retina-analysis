function f = tImpResp(tau, na, nb, tstep, n)%% TIMPRESP - make a mono- or biphasic temporal impulse response%% usage: %   TIMPRESP(TAU, NA, [NB], [TSTEP], [N])% 	TAU is time constant (e.g. 6 msec)% 	NA is positive component order (e.g. 2)% 	NB [optional] is negative component order (e.g. 10)%	for monophasic, enter two args. or set nb=0.% 	TSTEP [optional] specifies msec/element%	N [optional] specifies length of returned vector%     % see also: dog, gaus, gab, simpStim% % Lawrence K. Cormack and Scott B. Stevenson% history:% 2/24/01 lkc wrote it% 3/30/01 sbs did something to it% 7/2/02    lkc Cleaned up comments. if nargin < 2,	error('timpResp: must specify tau and na.  try 6 and 2')elseif nargin < 4,	tstep = 1;	n = 128;elseif nargin < 5,	n = 128;elseif nargin > 5,	error('timpResp: too many args')endtmax = (n-1).*tstep;t=0:tstep:tmax;afact = prod(1:na-1);a = (t./tau).^(na-1) .* exp(-t./tau) ./ (tau*afact);f = a;if ((nargin > 2) & (nb ~= 0)),			%*** if bi-phasic ***	bfact = prod(1:nb-1);	b = (t./tau).^(nb-1) .* exp(-t./tau) ./ (tau*bfact);	f = f - b;end