function w = filtNoise(k, n);% FILTNOISE - filtered noise% usage: y = filtNoise(k, n) - k is a kernel smaller than nxn% make an nxn image of gaussian noise filtered with the kernal k% much faster than conv2 for anything but tiny stimulis = size(k);if max(s)>n	error('kernal cannot be larger than stimulus')end %N = randn(n);% *** for binary noise ********N = (0.5 + sign(randn(n))./2); % 0 to 1fk = zeros(n);fk(1:s(1), 1:s(2)) = k;fw = fft2(fk).*N;w = real(ifft2(fw));